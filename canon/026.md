# Metacognitive particles, mental action and the sense of agency 

Lars Sandved-Smith ${ }^{1, *}$, Lancelot Da Costa ${ }^{2,3,4, *}$<br>${ }^{1}$ Monash Centre for Consciousness and Contemplative Studies, Monash University, Australia<br>${ }^{2}$ VERSES AI Research Lab<br>${ }^{3}$ Department of Mathematics, Imperial College London<br>${ }^{4}$ Wellcome Centre for Human Neuroimaging, University College London


#### Abstract

This paper articulates metacognition using the language of statistical physics and Bayesian mechanics. Metacognitive beliefs, defined as beliefs about beliefs, find a natural description within this formalism, which allows us to define the dynamics of 'metacognitive particles', i.e., systems possessing metacognitive beliefs. We further unpack this typology of metacognitive systems by distinguishing passive and active metacognitive particles, where active particles are endowed with the capacity for mental actions that update the parameters of other beliefs. We provide arguments for the necessity of this architecture in the emergence of a subjective sense of agency and the experience of being separate from the environment. The motivation is to pave the way towards a mathematical and physical understanding of cognition and higher forms thereof - furthering the study and formalization of cognitive science in the language of mathematical physics.


Keywords: Bayesian mechanics, Free-energy principle, Markov blanket, Langevin equation, Metacognition, Agency, Computational phenomenology

## Contents

1 Introduction 2

2 Systems, states and fluctuations 2

2.1 Notation . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 2

3 Particles and things 3

3.1 Sensorimotor boundaries . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 4

3.2 Cognitive and metacognitive particles . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 4

4 An example of a passive metacognitive particle 5

5 Nested particles and active metacognition 6

6 Strange metacognitive particles and the sense of agency 7

7 Higher forms of metacognition 9

8 Discussion 9

8.1 Infinite regress and the cognitive core . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 9

8.2 Mathematical characterization . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 10

8.3 Computational phenomenology . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 10

8.4 Empirical testing . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 11[^0]

## 1 Introduction

In this theoretical paper we provide a link between classical physics and metacognition. We ask: what could metacognition look like in simple physical terms? We adopt a Bayesian mechanical lens, where we define metacognition as having beliefs about beliefs. Under this definition, metacognition can be articulated simply using the language of statistical physics. We explore how the resulting architecture gives rise to formal notions of mental action and a subjective sense of agency. We then discuss connections to computational phenomenology, making preliminary empirical predictions and highlighting directions for future work. The motivation is to pave the way towards a mathematical and physical understanding of cognition - and its higher forms - furthering the study and formalization of cognitive science using mathematical physics.

## 2 Systems, states and fluctuations

We consider a system over some period of time. For simplicity, and ease of exposition, we assume that the system evolves according to a stochastic differential equation (a.k.a. Langevin equation):

$$
\dot{x}(t)=f(x(t))+w(t)
$$

This equation decomposes the motion of the system over some state space in terms of what we know about the system, specified in terms of the flow $f$ - a vector field on the state space - and what we don't know about the system; summarized by a noise process $w$, that represents random fluctuations, and which is usually assumed to be a mean-zero stationary Gaussian process (by the central limit theorem). This functional form for the dynamics will conveniently enable us to write down the causal relationships between different subsets of states in terms of the flow later on.

This is a natural place to start because much of physics, and in particular statistical physics, quantum mechanics and classical mechanics can be formulated with stochastic differential equations. In short, if we want a physics of cognition that is compatible with the rest of physics, then this is the right place to start.

A stochastic differential equation is an implicit specification of the random trajectories of the system, as a function of the flow and the random fluctuations. The fact that the fluctuations are random means that the system also exhibits a degree of randomness, and can only be described probabilistically.

### 2.1 Notation

In what follows, we denote trajectories of the system by $x$ (a random variable on a space of path 1 over state space) and trajectories of the noise process by $w$ (idem). We will denote the state of the system, and the state of random fluctuations at some time point $t$ by $x(t)$ and $w(t)$ (random variables over state space). Each of these random variables can be equivalently described by a probability distribution, over state space or path space, e.g. $P(x(t))$ and $P(x)$ respectively. We use capital $P$ to emphasize that we operate with distributions over random variables which may or may not admit densities. For intuition, it is useful to think of them as densities though. We will use an analogous notation for all other stochastic processes that we will encounter later, i.e. subparts of the system.

![](https://cdn.mathpix.com/cropped/2024_05_22_beaf88da22d24fd6fa1eg-03.jpg?height=469&width=1650&top_left_y=226&top_left_x=232)

Figure 1: Particles and Markov blankets. The left diagram illustrates the temporal unfolding of external paths (blue) and internal paths (green), as separated by blanket paths (orange). Internal and external paths can only interact via the intermediary blanket paths. The right diagram depicts the conditional dependencies of the paths of a system $x=(\eta, b, \mu)$. Arrows represent the direction of influence between paths. A key aspect of this interaction is that the external paths can only impact themselves and sensory paths, while the internal states are restricted to influencing themselves and the active paths. By increasing the sparsity and removing the interaction from active paths to internal paths we recapture the notion of a strange particle defined in 11 .

## 3 Particles and things

Any object of study in our system - over the period of time that it is observed - must by definition be distinguishable from the rest of the system. This in turn implies a boundary that separates the internal paths of the object from its external paths. We thus partition the system into external, boundary and internal:

$$
x=(\eta, b, \mu)
$$

Mathematically, the boundary paths must constitute a Markov blanket between the external and internal paths

$$
\eta \perp \mu \mid b \Longleftrightarrow P(\eta, \mu \mid b)=P(\eta \mid b) P(\mu \mid b) \Longleftrightarrow P(\eta \mid b, \mu)=P(\eta \mid b) \Longleftrightarrow P(\mu \mid b, \eta)=P(\mu \mid b)
$$

(3) formalises the physical intuition that all interactions between internal and external states happen via the boundary. See Figure 1 (left) for an illustration.

For this reason, we will use the terms boundary and blanket interchangeably henceforth. In turn, we will call the object of study, thing, or person - formed by internal and blanket states - a particle. This is in reference to the fact that a particle could describe a simple microscopic particle from statistical physics, a large particle like a planet as considered in classical mechanics or general relativity, or a biological organism - like a cell or a human being - as considered in biophysics. See Figure 1 (right).

Perhaps the simplest functional form for the dynamics that guarantees a Markov blanket is as follows

$$
\left[\begin{array}{c}
\dot{\eta} \\
\dot{b} \\
\dot{\mu}
\end{array}\right](t)=\left[\begin{array}{c}
f_{\eta}(\eta, b) \\
f_{b}(\eta, b, \mu) \\
f_{\mu}(b, \mu)
\end{array}\right](t)+\left[\begin{array}{c}
w_{\eta} \\
w_{b} \\
w_{\mu}
\end{array}\right](t)
$$

when the random fluctuations on external, blankets and internal states are independent.[^1]

### 3.1 Sensorimotor boundaries

In turn, we subdivide the boundary or blanket into what we call sensory and active paths

$$
b=(s, a)
$$

We operationally define sensory paths as those boundary paths that influence internal paths directly, but are not directly influenced by internal paths. In turn, we define active paths as those which influence external paths directly but are not directly influenced by external paths; then the motion of the system may read as follows:

$$
\left[\begin{array}{l}
\dot{\eta} \\
\dot{s} \\
\dot{a} \\
\dot{\mu}
\end{array}\right](t)=\left[\begin{array}{l}
f_{\eta}(\eta, s, a) \\
f_{s}(\eta, s, a) \\
f_{a}(s, a, \mu) \\
f_{\mu}(s, a, \mu)
\end{array}\right](t)+\left[\begin{array}{l}
w_{\eta} \\
w_{s} \\
w_{a} \\
w_{\mu}
\end{array}\right](t)
$$

See Figure 1 (right) for an illustration.

### 3.2 Cognitive and metacognitive particles

We say that a particle is cognitive whenever its internal paths parameterise beliefs about its external paths. Belief here is used in a technical sense to mean a conditional (i.e., Bayesian) probability distribution parameterised by some sufficient statistics. The defining property here is that there exists an assignment from internal paths to beliefs about external paths such that the most likely internal path given blanket paths encodes the posterior belief about external paths $\stackrel{2}{2}^{2}$

$$
\begin{aligned}
\mu & \mapsto Q_{\mu}(\eta) \\
Q_{\boldsymbol{\mu}}(\eta) & \triangleq P(\eta \mid s, a) \\
\boldsymbol{\mu} & \triangleq \arg \max _{\mu} P(\mu \mid s, a)
\end{aligned}
$$

Intuitively, this means that internal paths track the external world given the information on the boundary. Sufficient conditions for a particle to be cognitive are given in [11, 4, 21]. Note that in some cases (i.e. under the generalised coordinate formulation of a stochastic differential equation) paths are parameterised by states, so that internal states parameterise beliefs about external paths [11; but we will not delve into these technicalities here.

Remark 3.1. In existing treatments of the free-energy principle, particles are taken to be cognitive by definition [11, 8, 12. We deliberately make a distinction here by saying that a particle is defined in terms of a Markov blanket that exists over some period of time - which corresponds to the definition of what it is to exist - while a cognitive particle is defined as a particle with approximate posterior beliefs (and implicitly internal states that can be individuated from boundary states in the well-defined sense above).

A metacognitive particle is a cognitive particle that has beliefs about its own beliefs (about external states of the world). This means that a subset of the internal states, say $\mu^{(2)}$, encodes posterior beliefs about another subset of the internal states, say $\mu^{(1)}$. We will call $\mu^{(2)}$ the higher-level internal paths and $\mu^{(1)}$ the lower-level internal paths in virtue of the fact that $\mu^{(2)}$ will be seen as encoding beliefs about $\mu^{(1)}$.

We make a further the distinction between passive metacognition and active metacognition. Passive metacognitive beliefs are parameterised by a subset of internal paths such that they can only influence the lower-level beliefs via their shared blanket paths (see Figure 2). For example, a person who is surprised by their sudden inability to taste coffee (a possible sign of pancreatic cancer) might introspect and act accordingly [17]. Active metacognitive beliefs are parameterised by higher-level internal paths that are separated from the lower-level paths by an internal Markov blanket (see Figure 3). The term active refers to the existence of higher-level active paths that influence the lower-level internal paths (see Section 5).[^2]

Note that in the active case, $\mu^{(1)}$ can constitute the entire set of parameters of the particle's belief about the world. Whereas passive metacognitive beliefs are necessarily about a subset of the parameters of the particle's belief about the world.

We now present some examples to see what this looks like.

## 4 An example of a passive metacognitive particle

![](https://cdn.mathpix.com/cropped/2024_05_22_beaf88da22d24fd6fa1eg-05.jpg?height=485&width=1136&top_left_y=603&top_left_x=511)

Figure 2: Example of a passive metacognitive particle. This particle is such that internal paths at the lower level (i.e. $\mu^{(1)}$ ) are hidden from internal paths at the higher level (i.e. $\mu^{(2)}$ ). In other words, higher level internal paths must infer the lower level internal paths via the blanket paths, leading to the metacognitive belief $Q_{\mu^{(2)}}^{(2)}\left(\mu^{(1)}\right)$. Because the lower level internal paths $\mu^{(1)}$ constitute only a subset of the parameters $\mu=\left(\mu^{(1)}, \mu^{(2)}\right)$ of the particle's belief about the world, and there are no higher level active paths; the particle has passive metacognition.

We rehearse an example of a passive metacognitive particle, first proposed in [3].

Consider a strange particl $3^{3}$ whose internal dynamics can be decomposed into two sets of paths $\mu \triangleq$ $\left(\mu^{(1)}, \mu^{(2)}\right)$, and such that the first set of paths is hidden from the second via the Markov blanket. That is, $\mu^{(2)}$ may influence $\mu^{(1)}$ directly, but $\mu^{(1)}$ may only influence $\mu^{(2)}$ vicariously, via the Markov blanket. To visualize and summarise, the defining system's dynamics are as follows:

$$
\left[\begin{array}{c}
\dot{\eta} \\
\dot{s} \\
\dot{a} \\
\dot{\mu}^{(1)} \\
\dot{\mu}^{(2)}
\end{array}\right](t)=\left[\begin{array}{c}
f_{\eta}(\eta, s, a) \\
f_{s}(\eta, s, a) \\
f_{a}(s, a, \mu) \\
f_{\mu^{(1)}}(s, \mu) \\
f_{\mu^{(2)}}\left(s, \mu^{(2)}\right)
\end{array}\right](t)+\left[\begin{array}{c}
w_{\eta} \\
0 \\
0 \\
0 \\
0
\end{array}\right](t)
$$

The form of the coupling can also be seen in Figure 2

In this setting, it can be shown that sensory paths form a Markov blanket between higher- and lower-level internal paths [11, eq. 29]. Put simply, given the sensory paths, there is no further information in the lower level paths that is not inherent in the higher level paths.

$$
\left(\mu^{(2)} \perp \eta, a, \mu^{(1)}\right) \mid s
$$

In particular, the lower-level internal paths can only be inferred vicariously by the higher-level internal paths[^3]via the sensory paths. So we can define metacognitive beliefs encoded by the higher-level internal path:4

$$
\begin{aligned}
\mu^{(2)} & \mapsto Q_{\mu^{(2)}}^{(2)}\left(\eta, a, \mu^{(1)}\right) \\
Q_{\boldsymbol{\mu}^{(2)}}^{(2)}\left(\eta, a, \mu^{(1)}\right) & \triangleq P\left(\eta, a, \mu^{(1)} \mid s\right) \\
\boldsymbol{\mu}^{(2)} & \triangleq \arg \max _{\mu^{(2)}} P\left(\mu^{(2)} \mid s\right)
\end{aligned}
$$

This sort of belief is interesting because it implies that the higher internal paths encode beliefs about beliefs, licensing the metacognitive terminology. Perhaps the easiest way to see this is when the particular beliefs factorise according to a mean-field approximation:

$$
Q_{\mu}(\eta)=Q_{\mu^{(2)}}(\eta) Q_{\mu^{(1)}}(\eta)
$$

Then the (marginal) metacognitive belief

$$
Q_{\mu^{(2)}}^{(2)}\left(\mu^{(1)}\right) \triangleq \iint Q_{\mu^{(2)}}^{(2)}\left(\eta, a, \mu^{(1)}\right) \mathrm{d} \eta \mathrm{d} a
$$

is a belief about the belief $Q_{\mu^{(1)}}(\eta)$. The upshot is that this particle has passive metacognition because it has beliefs only about a subset of the parameters of its beliefs about the world, with no ability to influence these directly. See [16] for an example of an active inference simulation of a passive metacognitive particle.

The reader may notice that metacognitive beliefs are about the parameters of lower level beliefs, and wonder whether this justifiably entails beliefs about beliefs. We point out that indeed it does: a Bayesian belief is a probability distribution, which may be fully described - as is the case here - by its parameters or sufficient statistics. Defining a probability distribution over the sufficient statistics, or parameters, of a belief thus amounts to a (metacognitive) belief about this belief.

Next we consider a different class of particles that is comprehensively metacognitive in the richer sense that it has beliefs about all of the [the sufficient statistics of] its beliefs about the world. These are nested particles.

## 5 Nested particles and active metacognition

Here we consider nested particles, i.e. particles within particles. See Figure 3 for an illustration. We defer the dynamics of a nested particle to Appendix A as it is not essential for our discussion. The point is that the lower level internal paths $\mu^{(1)}$ (from the outer particle) can encode posterior beliefs about external paths, given lower level blanket paths:

$$
\begin{aligned}
\mu^{(1)} & \mapsto Q_{\mu^{(1)}}(\eta) \\
Q_{\boldsymbol{\mu}^{(1)}}(\eta) & \triangleq P\left(\eta \mid s^{(1)}, a^{(1)}\right) \\
\boldsymbol{\mu}^{(1)} & \triangleq \arg \max _{\mu^{(1)}} P\left(\mu^{(1)} \mid s^{(1)}, a^{(1)}\right)
\end{aligned}
$$

Further, the internal paths of the inner particle can hold beliefs about the lower level internal paths, which from the perspective of the inner particle are external paths:

$$
\begin{aligned}
\mu^{(2)} & \mapsto Q_{\boldsymbol{\mu}^{(2)}}\left(\mu^{(1)}\right) \\
Q_{\boldsymbol{\mu}^{(2)}}\left(\mu^{(1)}\right) & \triangleq P\left(\mu^{(1)} \mid s^{(2)}, a^{(2)}\right) \\
\boldsymbol{\mu}^{(2)} & \triangleq \arg \max _{\mu^{(2)}} P\left(\mu^{(2)} \mid s^{(2)}, a^{(2)}\right)
\end{aligned}
$$

In is the case, the higher level internal paths $\mu^{(2)}$ are metacognitive, in the sense that they parameterise beliefs about the parameters $\mu^{(1)}$ of beliefs about the world. This form of hierarchical depth can therefore be described as a 'parametric depth' [23]. For instance, if beliefs about the world are Gaussian:[^4]

![](https://cdn.mathpix.com/cropped/2024_05_22_beaf88da22d24fd6fa1eg-07.jpg?height=608&width=1627&top_left_y=249&top_left_x=257)

Figure 3: Nested particles. This diagram illustrates the decomposition of a system $x$ that contains a nested metacognitive particle. The right diagram shows the nested structure of a metacognitive particle, which possesses an internal Markov blanket separating higher-level internal paths $\mu^{(2)}$ from lower-level internal paths $\mu^{(1)}$. The left diagram depicts the conditional dependencies between paths of a metacognitive system. Thought bubbles illustrate the Bayesian beliefs parameterised by the internal paths, about paths external to them.

$$
Q_{\mu^{(1)}}(\eta)=\mathcal{N}(\eta ; m, \Pi)
$$

where the mean $m=m\left(\mu^{(1)}\right)$ and the precision $\Pi=\Pi\left(\mu^{(1)}\right)$ are functions of the sufficient statistic $\mu^{(1)}$. Then higher level internal paths $\mu^{(2)}$ possess beliefs about the sufficient statistics of that Gaussian. The higher level internal paths $\mu^{(2)}$ sense those parameters via the higher level sensory paths $s^{(2)}$ that are constituted by the higher level boundary.

In turn, the active trajectories at the higher level $a^{(2)}$ can modulate those parameters of beliefs about the world (e.g. posterior precision, which can be seen as a proxy for attention [23]). This formally encapsulates notions of 'mental actions' that modulate the parameters of a lower level generative model (cf. [25, 2, 19, 20] and [23] for an example). These inner particles look as if they are inferring mental action policies that minimise their expected free energy, i.e. performing higher order planning as inference.

Nested particles satisfying (13) and (14) are comprehensively metacognitive in the sense that the higher-level internal paths - that is the internal paths of the inner particle - encode posterior beliefs about all [of the sufficient statistics] of the beliefs which the (outer) particle holds about the world. This necessarily entails active metacognitive control over the parameters of lower level beliefs, if the internal blanket comprises active and sensory paths. This can be understood as a form of self-control since the consequence of higher level policies is the manifest dependency of paths internal to the particle.

![](https://cdn.mathpix.com/cropped/2024_05_22_beaf88da22d24fd6fa1eg-07.jpg?height=51&width=1645&top_left_y=2002&top_left_x=240)
and sensory paths - and thus metacognitive control - where metacognitive beliefs are only about a subset of lower-level internal paths, making them partially metacognitive.

## 6 Strange metacognitive particles and the sense of agency

Recall that strange particles as defined in [11 are such that active paths do not directly influence internal paths, and random fluctuations on the blanket and internal states are negligible. In 11 the authors point out that although a strange particle (8) possesses a form of agency - defined as possessing active paths that depend upon internal paths - the particle is unable to infer that they are indeed the agent of their actions. Regarding strange particles they write:

"From the perspective of someone observing an agent, say a fish, it will look as if the fish searches out particles of food. However, from the point of view of the fish, it believes that it is propelled through water in a fortuitous and benevolent way that delivers food particles to its mouth. In other words, the fish is not aware it is the agent of its actions, it just believes this is how the world works $[\ldots]$ " [11, p. 27$]$.

The authors proceed to posit that an agent capable of recognising that their actions are underwritten by agency may require a generative model exhibiting hierarchical depth, namely endowed with beliefs about beliefs. With metacognitive particles as defined here, we can make explicit the justification for this statement. Quite simply, a strange cognitive particle only has beliefs about active and external paths and therefore can never form a belief about the relationship between internal paths $\mu^{(1)}$ and active paths $a^{(1)}$. In order words, they lack the vantage point to realise that they (i.e. their internal paths) are causally upstream of their actions.

A strange, active metacognitive particle, however, has (metacognitive) beliefs about its lower-level internal paths. Hence they have the capacity to form a belief about the causal dependency of $a^{(1)}$ on $\mu^{(1)}$. We posit that this belief can be understood as the particle's sense of agency.

We now make this explicit mathematically. The dynamical equations governing our strange particle are (24), where we have removed the causal direction $a^{(1)} \rightarrow \mu^{(1)}$ and random fluctuations on all particular paths, i.e. internal, sensory and active paths 12 . This lack of a direct influence $a^{(1)} \rightarrow \mu^{(1)}$ implies that lower-level internal paths must infer lower-level active paths via lower-level sensory paths (in addition to external paths). The construction in [11] yields the following strange beliefs (held by a wide class of such strange particles)

$$
\begin{aligned}
\mu^{(1)} & \mapsto Q_{\mu^{(1)}}\left(\eta, a^{(1)}\right) \\
Q_{\boldsymbol{\mu}^{(1)}}\left(\eta, a^{(1)}\right) & \triangleq P\left(\eta, a^{(1)} \mid s^{(1)}\right)
\end{aligned}
$$

Marginalising these beliefs over external paths yields a low level belief about active paths:

$$
\begin{aligned}
& Q_{\mu^{(1)}}\left(a^{(1)}\right) \triangleq \int Q_{\mu^{(1)}}\left(\eta, a^{(1)}\right) \mathrm{d} \eta \\
& Q_{\boldsymbol{\mu}^{(1)}}\left(a^{(1)}\right)=P\left(a^{(1)} \mid s^{(1)}\right)
\end{aligned}
$$

Invoking the comprehensive metacognitive beliefs held by the particle (14), the sense of agency is the joint probability distribution

$$
\begin{aligned}
& Q_{\mu^{(2)}}\left(\mu^{(1)}, a^{(1)}\right) \triangleq Q_{\mu^{(2)}}\left(\mu^{(1)}\right) Q_{\mu^{(1)}}\left(a^{(1)}\right) \\
& Q_{\boldsymbol{\mu}^{(2)}}\left(\mu^{(1)}, a^{(1)}\right)=P\left(\mu^{(1)} \mid s^{(2)}, a^{(2)}\right) Q_{\mu^{(1)}}\left(a^{(1)}\right) \\
& Q_{\boldsymbol{\mu}^{(2)}}\left(\boldsymbol{\mu}^{(1)}, a^{(1)}\right)=P\left(\mu^{(1)} \mid s^{(2)}, a^{(2)}\right) P\left(a^{(1)} \mid s^{(1)}\right) \approx P\left(a^{(1)}, \mu^{(1)} \mid s^{(2)}, a^{(2)}\right)
\end{aligned}
$$

(18) defines a joint probability distribution over lower level internal and active paths which means that it captures the statistical relationship between (lower level) internal and active paths; hence a sense of agency. A sense of no agency would be when we believe that (lower level) internal and active paths are independent so that they do not influence each other:

$$
\begin{aligned}
Q_{\mu^{(2)}}\left(\mu^{(1)}, a^{(1)}\right) & =Q_{\mu^{(2)}}\left(\mu^{(1)}\right) Q_{\mu^{(2)}}\left(a^{(1)}\right) \\
Q_{\mu^{(2)}}\left(a^{(1)}\right) & \triangleq \int Q_{\mu^{(2)}}\left(\mu^{(1)}, a^{(1)}\right) \mathrm{d} \mu^{(1)}
\end{aligned}
$$

Under this perspective, the sense of agency implies a (subjective) measure of the strength of agency as the mutual information between (lower level) internal and active paths under our beliefs:

$$
\mathrm{D}_{\mathrm{KL}}\left[Q_{\mu^{(2)}}\left(\mu^{(1)}, a^{(1)}\right) \mid Q_{\mu^{(2)}}\left(\mu^{(1)}\right) Q_{\mu^{(2)}}\left(a^{(1)}\right)\right]
$$

This measure can be read as a metacognitive framing of empowerment in active inference: c.f., 14, 18.

![](https://cdn.mathpix.com/cropped/2024_05_22_beaf88da22d24fd6fa1eg-09.jpg?height=521&width=1613&top_left_y=246&top_left_x=256)

Figure 4: Multiply nested particles. This diagram recapitulates the architecture shown in Figure 3, now extended to $N$ levels of nested metacognition. Each internal path parameterises beliefs about the paths external to it. Note that the inner most paths, $\mu^{(N)}$, are not the target of further metacognitive beliefs.

## 7 Higher forms of metacognition

One can go further and consider multiply nested particles, that is a particle within a particle within a particle, etc. See Figure 44 Proceeding exactly as above, the internal paths at the highest level can encode beliefs about the internal paths of the level below and so forth. And the internal paths at the lowest level encode beliefs about external paths. In this case we have a particle with as many levels of metacognition as there are nested particles. At each level, the active path can influence the internal path at the level below, which itself influences the sensory path at the current level, which in turn influences the internal path, closing the (mental) action (mental) perception loop. The nested specification is equivalent to saying that the generative model $P(x)$ describing the system is a hierarchical model with as many levels as there are nested components. Finally, multiply nested particles may be $N$-times comprehensively metacognitive in the sense that at each level the internal paths hold beliefs about all of the internal paths at the level below (See Section 8.1 Equation 22 .

Although not depicted here, we can also consider a suitable generalisation of our partially metacognitive particle that exhibits higher order metacognition - as first proposed in [3. Consider the particle of figure 2 with a directed causal chain of internal paths $\mu^{(N)} \rightarrow \mu^{(N-1)} \rightarrow \ldots \rightarrow \mu^{(1)}$ generalising the chain $\mu^{(2)} \rightarrow \mu^{(1)}$. In this case, the internal paths at any level, say $\mu^{(n)}$, can encode beliefs about all of the internal paths at the levels below, i.e. $\left(\mu^{(n-1)}, \ldots, \mu^{(1)}\right)$. In particular, the internal path at the highest level $\mu^{(N)}$, can encode beliefs about the internal path at the level below $\mu^{(N-1)}$, which itself encodes beliefs about the internal path one level further down $\mu^{(N-2)}$ etc, until $\mu^{(1)}$. In this case, then the particle is $N$-times partially metacognitive, because $\mu^{(N)}$ encodes a chain of $N$ beliefs about $\mu^{(1)}$, and $\mu^{(1)}$ is one of $N$ parameters governing the belief of the particle about the world.

Note that a multiply nested particle may also have partially metacognitive layers where, say, the $n$-th level internal paths are subdivided into two components $\mu^{(n)} \triangleq\left(\mu^{(n, 1)}, \mu^{(n, 2)}\right)$ and the internal paths at the level above only hold beliefs about one of those components, e.g. the partially metacognitive belief $Q_{\mu^{(n+1)}}\left(\mu^{(n, 1)}\right)$.

## 8 Discussion

There are many issues that attend this description of metacognitive particles. We take the opportunity to discuss four key points:

### 8.1 Infinite regress and the cognitive core

In considering multiply nested particles, two natural questions might arise.

The first is whether there is a limitation on the potentially infinite number of nested blankets. The limitation is not given by the treatment in this paper but by the free energy principle [11, 12, The free energy principle shows that particles will tend to minimise the complexity of their beliefs while maximising their predictive accuracy (about what lies beyond each blanket). Here, we simply say that additional nested parametric depth incurs additional complexity (in terms of additional beliefs), which must be outweighed by the predictive improvement afforded by its inclusion. Hence the number of layers remains finite and limited by the complexity-accuracy trade off implicit in free-energy minimization [11, 12 ].

As a result, we conjecture the existence of innermost internal paths $\mu^{(N)}$ that cannot be inferred by higher level metacognitive beliefs (see Figure 4). This creates a fundamental limitation on self-representation in a system: there will always be a 'cognitive core' with internal paths encoding beliefs, whilst never being the target of further higher-order beliefs. This was elegantly expressed by 10 as: "I can never conceive of what it is like to be me, because that would require the number of recursions I can physically entertain, plus one". Furthermore, this limitation has been demonstrated by [7] within the quantum information theoretic formulation of the free-energy principle, and is in agreement with the notion of an 'irreducible Markov blanket' presented in $[22$.

If we subscribe to the notion that subjective experience is related to the information encoded by approximate posterior beliefs, the second question that might arise is how multiple nested Markov blankets can be reconciled with a single, unified, field of experience. This question assumes a relationship between the beliefs parameterised by internal paths and phenomenology. This is an ongoing debate; however, we simply point out that despite the apparent separation between nested layers, the beliefs parameterised by the innermost paths are about the most deeply nested internal paths of all other layers, as well as external paths. Hence the information encoded on the internal Markov blanket captures all the information encoded on lower blankets. We can see this mathematically by expressing the beliefs held by the cognitive core. Assuming one layer of metacognition (i.e. Figure 3 ):

$$
Q_{\mu^{(2)}}\left(\eta, \mu^{(1)}\right) \triangleq Q_{\mu^{(1)}}(\eta) Q_{\mu^{(2)}}\left(\mu^{(1)}\right)
$$

This can be extended to multiply nested particles (i.e. Figure 4), giving:

$$
Q_{\mu^{(N)}}\left(\eta, \mu^{(1)}, \ldots, \mu^{(N-1)}\right) \triangleq Q_{\mu^{(1)}}(\eta) \prod_{n=2}^{N} Q_{\mu^{(n)}}\left(\mu^{(n-1)}\right)
$$

Hence there is a formal object that has the structure of a unified experience if we assume a relationship between phenomenology and information encoded by the approximate posterior belief - something referred to as extrinsic information geometry $[13]$.

### 8.2 Mathematical characterization

Although we have conceptually described several types of particles in terms of beliefs encoded by different types of internal paths, one important avenue is to determine the exact conditions on their dynamics for these beliefs to exist. These characterisations usually necessitate focusing on a particular functional form for the dynamics driving the system, and sufficient conditions have been given in several cases [11, 4]. The point for this article thus far is this: these beliefs exist in a wide class of particles subject to the dynamics considered. Metacognitive particles exist - according to our particular definition. Future work will address the specific conditions that particles meeting our definition must meet, which will in turn enable numerical simulations of their belief dynamics.

### 8.3 Computational phenomenology

Perhaps more interestingly is the link between the theoretical treatment presented here and computational models of introspection and meta-awareness describing metacognitive processes such as meditation. As we attempt a mathematical definition of metacognition, this raises the question whether the description presented in this paper could be refined to get closer to our computational and empirical understanding of
this phenomenon. Recent advances in active inference modelling of meditation suggest that some aspects can be adequately modelled as active inference under a hierarchical generative model where actions at the higher level modulate the precisions (i.e. inverse covariances) of beliefs encoded by the level below [23]. From this perspective, this amounts to the behaviour of multiply nested strange particles [11], where inner particles hold beliefs about active paths that influence the [sufficient statistics of the] beliefs held by the lower-level particle. There is an interesting road ahead where computational models of meditation furnish examples of what we would expect from metacognitive phenomenology, and theoretical treatments along these lines showing general conditions for the phenomenology described by these models to arise.

For example, a central theme in contemplative practices such Mahamudra or self-inquiry is the first person investigation of the apparent sense separation from the external world. In these practices, attention is directed towards the impression of perceiving things 'over there' from a perspective that is 'in here'. In a similar way that the sense of agency can be related to the joint probability distribution over internal and active paths (Section 6), this sense of separation finds a potential mathematical candidate in the joint probability distribution over internal and external paths. This belief will necessarily encode the understanding that what is internal to me is separated from what is external, since the Markov blanket enforces a conditional independence of internal and external paths.

This implies that non-metacognitive particles, in the absence of beliefs about internal paths, might possess a 'pre-dual', as well as non-agentive, phenomenology. Duality, understood as a sense of separation, then emerges as a consequence of metacognitive self-representation, i.e. beliefs about beliefs. We propose that further non-dual modes of experience might, in principle, be amenable to mathematical description within Bayesian mechanics.

A full exploration of this direction is beyond the scope of this paper, the aim here has been to present an architecture and formalism that might provide a mathematically grounded way of thinking about these fundamental themes in contemplative phenomenology, and metacognitive phenomenology more generally.

### 8.4 Empirical testing

In principle, it should be possible to experimentally demonstrate whether any given particle (e.g., molecules, mice, or men) falls within the description of particles presented here by examining the structure and nature of their dynamics. Practically, this would require 1) inferring the dynamics from empirical data - e.g. through Bayesian selection of stochastic dynamical models based on timeseries from a particle and its surrounding milieu - and then 2) analyzing whether the resulting structure conforms to the mathematical characterization of metacognition discussed above. On a practical level, there are procedures for identifying nested Markov blankets from empirical timeseries, allowing the identification of multiply nested particles. Please see [9] for a worked example using brain imaging data. Whether these procedures find purchase in decomposing distributed systems across scales, in further empirical studies, remains to be seen.

It is possible to make empirical predictions in regards to the formalisation of the sense of agency. For example, we predict that the KL divergence in (20) will be zero, or low, in the absence of intentional binding 15.

Another possible vector of empirical investigation is to examine the nature of the influence of higher level dynamics on lower level paths via (mental) actions mediated by inner active paths. Notice that the mechanism of action between levels, of an active metacognitive particle, is to exert an influence on parameters of lower level beliefs. This has implications for the type of physical interactions that might enable such an influence. For example, in a metacognitive particle we would expect that the dynamics of higher level internal paths be at the origin of processes that impact the dynamics of lower level paths. In neurobiology this leads to predictions, for example, about the existence of neuronal populations whose activity is at the origin of neuromodulatory dynamics. In psychology, this might be read as establishing an attentional set or, more simply, attention $[1,5,20,23,24,26$.

## 9 Conclusion

We have proposed a definition of metacognition using statistical physics within the context of Bayesian mechanics and the free-energy principle. Metacognition, understood as the capacity for forming beliefs about beliefs, finds a natural mathematical articulation within this formalism. We have further distinguished various types and degrees of metacognition such as strong versus weak, active versus passive.

In doing so we find a mathematical homologue for the sense of agency (as distinct from the presence of agency in itself) and an argument for why metacognition thus defined is a necessary condition for this sense. We extend the typology of cognitive particles in [11 to include particles resembling something closer to ourselves, thus opening a direction for further empirical and mathematical investigation into the physical and informational dynamics at play in complex cognitive organisms.

## A Dynamics of nested particles

The dynamics of the nested system from Figure 3 is as follows:

$$
\left[\begin{array}{c}
\dot{\eta} \\
\dot{s}^{(1)} \\
\dot{a}^{(1)} \\
\dot{\mu}^{(1)} \\
\dot{s}^{(2)} \\
\dot{a}^{(2)} \\
\dot{\mu}^{(2)}
\end{array}\right](t)=\left[\begin{array}{c}
f_{\eta}\left(\eta, b^{(1)}\right) \\
f_{s^{(1)}}\left(\eta, b^{(1)}\right) \\
f_{a^{(1)}}^{\left(b^{(1)}, \mu^{(1)}\right)} \\
f_{\mu^{(1)}}\left(b^{(1)}, \mu^{(1)}, b^{(2)}\right) \\
f_{s^{(2)}}\left(\mu^{(1)}, b^{(2)}\right) \\
f_{a^{(2)}}\left(b^{(2)}, \mu^{(2)}\right) \\
f_{\mu^{(2)}}\left(b^{(2)}, \mu^{(2)}\right)
\end{array}\right](t)+\left[\begin{array}{c}
w_{\eta} \\
w_{s^{(1)}} \\
w_{a^{(1)}} \\
w_{\mu^{(1)}} \\
w_{s^{(2)}} \\
w_{a^{(2)}} \\
w_{\mu^{(2)}}
\end{array}\right](t)
$$

where $b^{(i)}=\left(s^{(i)}, a^{(i)}\right)$ for $i=1,2$ are the lower- and higher- level blankets, respectively. The dynamics governing the strange nested particles discussed in Section 6 are:

$$
\left[\begin{array}{c}
\dot{\eta} \\
\dot{s}^{(1)} \\
\dot{a}^{(1)} \\
\dot{\mu}^{(1)} \\
\dot{s}^{(2)} \\
\dot{a}^{(2)} \\
\dot{\mu}^{(2)}
\end{array}\right](t)=\left[\begin{array}{c}
f_{\eta}\left(\eta, b^{(1)}\right) \\
f_{s^{(1)}}\left(\eta, b^{(1)}\right) \\
f_{a^{(1)}}\left(b^{(1)}, \mu^{(1)}\right) \\
f_{\mu^{(1)}}\left(s^{(1)}, \mu^{(1)}, b^{(2)}\right) \\
f_{s^{(2)}}\left(\mu^{(1)}, b^{(2)}\right) \\
f_{a^{(2)}}\left(b^{(2)}, \mu^{(2)}\right) \\
f_{\mu^{(2)}}\left(b^{(2)}, \mu^{(2)}\right)
\end{array}\right](t)+\left[\begin{array}{c}
w_{\eta}(t) \\
0 \\
0 \\
0 \\
0 \\
0 \\
0
\end{array}\right]
$$

so that we removed the dependency of $f_{\mu^{(1)}}$ on $a^{(1)}$ in 23 .

## References

[1] Vivien Ainley et al. "'Bodily Precision': A Predictive Coding Account of Individual Differences in Interoceptive Accuracy". In: Philosophical Transactions of the Royal Society of London. Series B, Biological Sciences 371.1708 (Nov. 19, 2016), p. 20160003. DoI: 10.1098/rstb.2016.0003, pmid: 28080962

[2] Andy Clark. "The Many Faces of Precision (Replies to Commentaries on "Whatever next? Neural Prediction, Situated Agents, and the Future of Cognitive Science")". In: Frontiers in Psychology 4 (May 21, 2013). DoI: $10.3389 /$ fpsyg. 2013.00270

[3] Lancelot Da Costa and Lars Sandved-Smith. "Towards a Bayesian Mechanics of Metacognitive Particles: A Commentary on "Path Integrals, Particular Kinds, and Strange Things" by Friston, Da Costa, Sakthivadivel, Heins, Pavliotis, Ramstead, and Parr". In: Physics of Life Reviews 48 (Mar. 1, 2024), pp. 11-13. DOI: $10.1016 / j \cdot$ plrev.2023.11.014.

[4] Lancelot Da Costa et al. "Bayesian Mechanics for Stationary Processes". In: Proceedings of the Royal Society A: Mathematical, Physical and Engineering Sciences 477.2256 (Dec. 2021), p. 20210518. DOI: 10.1098/rspa.2021.0518, arXiv: 2106.13830

[5] Patrice Duquette. "Increasing Our Insular World View: Interoception and Psychopathology for Psychotherapists". In: Frontiers in Neuroscience 11 (Mar. 21, 2017). DOI: 10.3389/fnins.2017.00135.

[6] Detlef Dürr and Alexander Bach. "The Onsager-Machlup Function as Lagrangian for the Most Probable Path of a Diffusion Process". In: Communications in Mathematical Physics 60.2 (June 1, 1978), pp. 153170. DOI: 10.1007/BF01609446

[7] Chris Fields, James F. Glazebrook, and Michael Levin. "Principled Limitations on Self-Representation for Generic Physical Systems". In: Entropy 26.3 (3 Mar. 2024), p. 194. DoI: 10.3390/e26030194.

[8] Karl Friston. "A Free Energy Principle for a Particular Physics". In: arXiv:1906.10184 (q-bio) (June 2019). arXiv: 1906.10184 [q-bio]

[9] Karl Friston. "Hierarchical Models in the Brain". In: PLoS Computational Biology 4.11 (Nov. 2008). Ed. by Olaf Sporns, e1000211. Dor: 10.1371/journal.pcbi.1000211.

[10] Karl Friston, Christopher Thornton, and Andy Clark. "Free-Energy Minimization and the Dark-Room Problem". In: Frontiers in Psychology 3 (May 2012). DOI: 10.3389/fpsyg. 2012.00130.

[11] Karl Friston et al. "Path Integrals, Particular Kinds, and Strange Things". In: Physics of Life Reviews (Aug. 2023). DOI: $10.1016 / j \cdot$ plrev. 2023.08.016

[12] Karl Friston et al. "The Free Energy Principle Made Simpler but Not Too Simple". In: Physics Reports. The Free Energy Principle Made Simpler but Not Too Simple 1024 (June 2023), pp. 1-29. DoI: 10. $1016 / j \cdot$ physrep.2023.07.001.

[13] Karl J. Friston, Wanja Wiese, and J. Allan Hobson. "Sentience and the Origins of Consciousness: From Cartesian Duality to Markovian Monism". In: Entropy 22.5 (May 2020), p. 516. DoI: 10.3390/ e22050516.

[14] Danijar Hafner et al. "Action and Perception as Divergence Minimization". In: arXiv:2009.01791 [cs, math, stat] (Oct. 2020). arXiv: 2009.01791 [cs, math, stat]

[15] Patrick Haggard. "Sense of Agency in the Human Brain". In: Nature Reviews Neuroscience 18.4 (Apr. 2017), pp. 196-207. DoI: $10.1038 / \mathrm{nrn} .2017 .14$.

[16] Casper Hesp et al. "Deeply Felt Affect: The Emergence of Valence in Deep Active Inference". In: Neural Computation 33.2 (Feb. 1, 2021), pp. 398-446. DOI: 10.1162/neco_a_01341.

[17] Jakob Hohwy. The Predictive Mind. Oxford University Press, Nov. 2013. DoI: 10. 1093/acprof : oso/9780199682737.001.0001.

[18] A.S. Klyubin, D. Polani, and C.L. Nehaniv. "Empowerment: A Universal Agent-Centric Measure of Control". In: 2005 IEEE Congress on Evolutionary Computation. 2005 IEEE Congress on Evolutionary Computation. Vol. 1. Edinburgh, Scotland, UK: IEEE, 2005, pp. 128-135. DoI: 10.1109/CEC. 2005. 1554676

[19] Jakub Limanowski. "(Dis-)Attending to the Body(Dis-)Attending to the Body: Action and Self-Experience in the Active Inference Framework: Action and Self-Experience in the Active Inference Framework". In: Philosophy and Predictive Processing (2017). In collab. with Thomas K. Metzinger et al. DoI: $10.15502 / 9783958573192$.

[20] Jakub Limanowski and Karl Friston. "'Seeing the Dark': Grounding Phenomenal Transparency and Opacity in Precision Estimation for Active Inference". In: Frontiers in Psychology 9 (2018).

[21] Thomas Parr, Lancelot Da Costa, and Karl Friston. "Markov Blankets, Information Geometry and Stochastic Thermodynamics". In: Philosophical Transactions of the Royal Society A: Mathematical, Physical and Engineering Sciences 378.2164 (Feb. 2020), p. 20190159. DOI: 10.1098/rsta.2019.0159

[22] Maxwell James Ramstead et al. The Inner Screen Model of Consciousness: Applying the Free Energy Principle Directly to the Study of Conscious Experience. Apr. 20, 2023. DoI: 10.31234/osf.io/6afs3. URL: https://psyarxiv.com/6afs3/ (visited on 05/04/2023). preprint.

[23] Lars Sandved-Smith et al. "Towards a Computational Phenomenology of Mental Action: Modelling Meta-Awareness and Attentional Control with Deep Parametric Active Inference". In: Neuroscience of Consciousness 2021.1 (Jan. 2021), niab018. DOI: $10.1093 / \mathrm{nc} / \mathrm{niab018}$

[24] Biswa Sengupta et al. "Towards a Neuronal Gauge Theory". In: PLOS Biology 14.3 (Mar. 8, 2016), e1002400. DOI: $10.1371 /$ journal.pbio. 1002400

[25] Anil K. Seth. "Interoceptive Inference, Emotion, and the Embodied Self". In: Trends in Cognitive Sciences 17.11 (Nov. 2013), pp. 565-573. DOI: 10.1016/j.tics.2013.09.007. pmid: 24126130.

[26] Samuel P. L. Veissière et al. "Thinking through Other Minds: A Variational Approach to Cognition and Culture". In: Behavioral and Brain Sciences 43 (Jan. 2020), e90. DoI: 10.1017/S0140525X19001213.


[^0]:    ${ }^{*}$ Equal contribution. Correspondence: lars.sandvedsmith@gmail.com

[^1]:    ${ }^{1}$ We will refer to 'paths' as opposed to 'states' for technical reasons (that inherit from the path integral formulation of the free energy principle). Paths can be thought of as trajectories or events that traverse state space and behave, mathematically, very much like a variable or state. Indeed, a path can be treated as a state in generalised coordinates of motion.

[^2]:    ${ }^{2}$ With an abuse of notation for taking the maximum of a distribution; see 6 for the rigorous definition of this in our setting.

[^3]:    ${ }^{3}$ Strange particles, as defined in 11, are such that active paths do not directly influence (i.e. are hidden from) internal paths; and, accordingly, active paths are inferred by internal paths via sensory paths. The other defining condition is that random fluctuations on the blanket and internal states are negligible in virtue of the fact that the particle is assumed to be large, and modelled at a correspondingly large degree of coarse graining (cf. classical mechanics from statistical mechanics).

[^4]:    ${ }^{4}$ These exist in large class of particles in virtue of conditions analogous to that discussed in [11, p. 24].

